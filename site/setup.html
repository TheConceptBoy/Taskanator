<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskanator Setup</title>
    <link rel="stylesheet" href="styles/setup.css">
    <script src="scripts\jquery-3.7.1.min.js"></script>
    <script src="scripts/setup.js"></script>

    <link rel="stylesheet" href="styles/style.css">

    <script src="scripts/status_popups.js"></script>
    <link rel="stylesheet" href="styles/status_popups.css">
</head>
<body>
    <div class="top_text">Initial Setup for Taskanator</div>
    <div class="page_content">





        <div class="setup_section">
        
            <div class="two_half">

                <div class="stage_desc">
                    <div class="setup_step_title">1/4 Establish Database:</div>
                    Provide the username and password for your database engine. Also provide the name of the database which will be created to store taskanator boards, users, notes and other data. <br><br>
                    This username and password should already exist in your database. This step will not create a new one.
                </div>

                <div class="create_db_stage" id="setup_form">
                    <div id="stage_db_status" class="mini_status_box"></div>
                    <input id="db_user" type="username" placeholder="username">
                    <input id="db_password" type="password" placeholder="password">
                    <input id="db_database" type="text" placeholder="database to create" value="taskanator_db">
                    <input type="button" value="Perform Initial Setup" class="button_green" onClick="run_setup(this)">
                </div>

            </div>

        </div>








        <div class="setup_section" style="display: none;" id="section_2">
            <div class="two_half">

                <div class="stage_desc">
                    <div class="setup_step_title">2/4 Register Master User:</div> 
                    This is where you register the master account under which you will be creating your project boards, notes, and managing other users who have access to your boards. <br><br>
                    There can only be 1 master account. Once a master account is registered, all attempts to register another one will fail.
                </div>

                <form id="master_user_data" class="create_db_stage">
                    <div id="stage_user_status" class="mini_status_box"></div>
                    <input id="master_username" disabled type="username" name="master_user_email" placeholder="master user email">
                    <input id="master_password"  disabled type="password" name="master_password" placeholder="master user password">
                    <input id="master_fname"  disabled type="text" name="master_fname" placeholder="master user first name">
                    <input id="master_lname"  disabled type="text" name="master_lname" placeholder="master user last name">
                    <input disabled type="button" class="button_green" value="Register Master User" onClick="register_master_user(this)">
                </form>

            </div>
        </div>








        <div class="setup_section" style="display: none;" id="section_3">

            <div class="two_half">

                <div class="stage_desc">
                    <div class="setup_step_title">3/4 Permitted IP Addresses:</div> 
                    This is where you supply public IP filtering. Only requests originating from these IP addresses will be allowed to access the Taskanator Dashboard. <br><br> 
                    
                    You can find out your own IP by googling "Whats My IP" and visiting services like this: <a href="https://whatismyipaddress.com">https://whatismyipaddress.com</a>
                    
                    If you are hosting and planning to use this tool with team members, you need to acquire their <b>public</b> IP address (search "What's my IP" in google). <br><br>
                    Internet Service Providers tend to randomize client ip adrresses once in a while for security reasons. When that happens, the team member will lose their ability to access your instance of Taskanator. You will need to acquire their new ip and update it within the settings. <br><br>
                    If you're running Taskanator as a web application but locally (on the same computer you're accessing and using it on) and only for yourself, you only need the default ip address (192.168.0.1) <br><br>
                </div>
                
                <div class="ip_manifesto">
                    
                    <div id="stage_ip_status" class="mini_status_box"></div>
                    <div><input type="checkbox" disabled name="" id="enable_ip_filter" onChange="toggle_ip_filtering(this)"><label for="enable_ip_filter">Enable IP filtering</label></div>
                    <div>Add New Permitted ip</div>
                    <div id="setup_new_ip_field">
                        <input type="text" placeholder="name">
                        <input type="text" placeholder="description">
                        <div class="setup_ip_grid">
                            <input type="number" value="192"> <span> . </span>
                            <input type="number" value="168"> <span> . </span>
                            <input type="number" value="0"> <span> . </span>
                            <input type="number" value="1">
                        </div>
                        <input type="button" value="Add Ip Address" onclick="add_ip_to_list()">
                    </div>
                    
                    <div id="setup_ip_list">
                        <div class="ip_listing">
                            <span>localhost</span>
                            <span title="Default Local IP address. Used to access Taskanator when self hosting.">[hover for info]</span>
                            <span>192.168.0.1</span>
                            <input type="button" value="remove" onclick="move_ip_from_list(this)">
                        </div>
                    </div>

                    <input id="record_ip_filter" class="button_green" type="button" value="Record IP Exceptions and Finish Setup" disabled onclick="record_ip_filter(this)">
                </div>
                
            </div>
        </div>







        <div class="setup_section" id="section_4" style="display:none">
            <div class="setup_complete">
                <div class="setup_step_title">Setup Complete</div>
                
                <div>
                    Initial Setup Completed. You can proceed to the login page, where you can use your email and password to log into the dashboard. <br><br>
                    Once you Click "Proceed to Login Page", this setup page will be disabled. It will be moved outside of root directory and any server side setup commands will no longer accept commands. <br><br>
                    If you'd like to re-do the setup, you need to delete the old database and move the setup.html file back to the root of Taskanator (same location as index.html).
                </div>

                <input type="button" value="Proceed to Login Page" onclick="finish_setup()">
            </div>
        </div>
 



        
    </div>
    
</body>
</html>